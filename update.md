# UPDATE 更新与改进

## 要求

更新内容需要记录到update.md中，包括日期，更新内容，修改人。

## 已完成

1. **2026-01-29**:
    - 完成项目初始化，建立规范文档（spec.md, readme.md）。 (修改人: Antigravity)
    - 实现基于 Vite + React + ECharts 的核心数据分析与可视化功能。 (修改人: Antigravity)
    - 引入 PapaParse 支持 CSV/JSON 数据解析与自动日期分组。 (修改人: Antigravity)
    - 采用 Glassmorphism 磨砂玻璃 UI 设计。 (修改人: Antigravity)
    - 完成核心逻辑的单元测试 (Vitest) 并通过验证。 (修改人: Antigravity)
    - 创建 `start.sh` 快速启动脚本，并增加自动打开浏览器功能（仅在无错误启动时触发）。 (修改人: Antigravity)
2. **新增功能及修复 2026年1月29日 15:20**:
    - 增加数据文本拷贝导入功能 (Paste Import)。 (修改人: Antigravity)
    - 增加文件拖拽导入功能 (Drag & Drop)。 (修改人: Antigravity)
    - 修复 CSV 导入兼容性问题，现支持中文表头及分开的日期/时间列。 (修改人: Antigravity)
3. 改进：每个数值点加粗显示  2026年1月29日 20:33 ✅已完成
4. 改进：可以选择每个坐标轴的最大最小值 2026年1月29日 20:37 ✅已完成
5. bug修复：拖拽导入文件失效问题 2026年1月29日 20:45 ✅已完成
6. 确认：支持导入多个表的数据并在同一张图显示 2026年1月29日 20:49 ✅已完成
7. 改进：加入的数据可以在左侧删除 2026年1月29日 21:08 ✅已完成
8. 改进：上部图例超出则分行，不显示「粘贴数据_2033」等文件名相关字眼，仅在左侧显示 2026年1月29日 21:32 ✅已完成
9. 改进：坐标轴最大最小值设置与标签在同一行，增加默认按钮并显示默认数值 2026年1月29日 21:45 ✅已完成
10. 改进：增加导出数据功能，可将图里的数据导出 2026年1月29日 21:35 ✅已完成
11. 改进：提示后端是否正常 2026年1月29日 21:50 ✅已完成
12. 改进：增加可勾选查看曲线积分值 2026年1月29日 21:50 ✅已完成
13. 改进：纵坐标不在右侧显示，而是在放到曲线上时在左侧纵坐标切换 2026年1月29日 21:50 ✅已完成
14. 改进：修改名称为「数据曲线分析系统」 2026年1月29日 21:56 ✅已完成
15. 改进：增加对多维表多维度区分，比如时间-数据外，还有日期、城市筛选 2026年1月29日 21:58 ✅已完成
16. 改进：维度选择（如城市）重构为类似图例的标签（Tag）样式 2026年1月29日 22:08 ✅已完成
17. 改进：维度选择支持自由切换主维度（如城市、天气等），并采用图例多选标签样式 2026年1月29日 22:15 ✅已完成
18. 改进：根据数据值自动判断单位和积分单位 2026年1月29日 22:15 ✅已完成
19. 改进：优化导出按钮颜色并修复显示逻辑 2026年1月29日 22:15 ✅已完成
20. 改进：增加可以切换为浅色模式，浅色模式采用苹果公司网页风格 2026年1月30日 ✅已完成
21. 改进：改进左侧分析控制台UI，字体小一些，更紧凑 2026年1月30日 ✅已完成
22. 改进：坐标轴适当下移，避免图例分行与坐标轴重合 2026年1月30日 ✅已完成
23. 优化：整体优化UI字体大小、整齐，导出按钮颜色 2026年1月30日 ✅已完成
24. 改进：分析控制台可以改变宽度 2026年1月30日 ✅已完成
25. 改进：做一个按钮，可以一键隐藏/打开分析控制台 2026年1月30日 06:45 ✅已完成
26. 改进：「坐标轴设置」占比提高，占1/3，且「坐标轴设置」这几个字不纳入滚动条 2026年1月30日 06:45 ✅已完成
27. 改进：已选资料系列的部分分层了两行，做成1行就可以了 2026年1月30日 06:45 ✅已完成
28. 改进：粘贴数据界面按钮布局问题 2026年1月30日 06:45 ✅已完成
29. 流畅性优化：控制台的打开和隐藏也不够流畅，感到有些卡顿，排查并优化
30. bug：隐藏/显示的显示问题没有修复，切换宽窄功能没效果 ✅已完成
31. 极简化布局，消除空间浪费。 ✅已完成
32. 窗口缩小后，有时候曲线没有压缩 ✅已完成
33. bug：重复的图例不要重复显示，而是显示为1个，可以通过这个图例统一隐藏或显示
34. bug：网页在我鼠标放到圆点的时候，把我屏蔽的图例重新放开 ✅已完成
35. 改进分析控制台，适当减少行高 ✅已完成
36. 白天模式（苹果风格），有的字体白色看不清 ✅已完成
37. bug：文件拖拽打开功能失效 ✅已完成
38. 点击恢复默认按钮，仅修改该项的值并生效，不要修改其他设置 ✅已完成
39. bug：隐藏默认纵坐标的图例后，纵坐标不会自动切换 ✅已完成
40. 显示积分值这几个字字号太大 2026年1月30日 15:10 ✅
41. 改进：固定坐标轴，而不是随着纵坐标的改变而移动，现在还是会移动，因为纵坐标可能太靠左边了 2026年1月30日 15:10 ✅
42. 改进：数值可以修改展示方式，比如曲线、柱状图等，暂时不见效果 2026年1月30日 15:10 ✅
43. 白天/黑夜两个风格排版有些微区别  2026年1月30日 15:23 ✅
44. 改进：鼠标放到圆点上，放大效果还是不够明显，有没有更好的方式？ 2026年1月30日 15:27 ✅
45. 优化：需要将两个日期多选，两个日期的曲线在同一张图显示 2026年1月30日 15:27 ✅
46. 优化：在界面适当增加引导用户使用的提示或说明等 2026年1月30日 15:27 ✅
47. 优化：放到圆点上时，其他曲线变得太暗了，看不清 ✅已完成 2026年1月30日 15:43
48. 改进：刷新后也保留原画面 ✅已完成 2026年1月30日 15:43
49. 改进：增加历史数据保存功能，可以将当前曲线保存为历史随时调阅 ✅已完成 2026年1月30日 15:47
50. 改进：如果一个图例（数据）有2条曲线，想办法区别开 ✅已完成 2026年1月30日 15:47
51. 改进：增加选项，选择曲线后其他曲线不要变暗 ✅已完成  2026年1月30日 16:02
52. BUG：历史数据读取有问题，读取不到历史所有曲线 ✅已修复 (保存数据副本至快照)2026年1月30日 16:02
53. BUG：同时选择两个日期后，图例就不见了 ✅已修复 (同步 Legend Data 与 DisplayName)2026年1月30日 16:02
54. 增加：关闭后端的脚本 ✅已完成 (stop.sh)2026年1月30日 16:02
55. 部署：我要讲这个WEB部署到qnap的docker中，用户名：yjiefl，ip：192.168.3.10，端口：22222 ✅已完成 (提供 Dockerfile / docker-compose)
56. **视觉升级**: 浅色模式背景更新为苹果风格的浅灰色 (#f5f5f7)，并通过区域底色区分侧边栏与图表区。 ✅
57. 改进：将历史数据独立顶部选项卡，方便管理和打开等操作 ✅已完成 2026年1月30日 22:54
58. **适配优化**: 针对浅色模式全面调优了坐标轴、提示框及文字颜色，提升阅读对比度。 ✅ 2026年1月30日 22:54
59. bug：点击删除只删除当前显示，不要删除历史存单 ✅ 2026年1月30日 22:54
60. 修复了“清空数据”会连同历史存单一并删除的问题，增加了清空确认提示。 ✅2026年1月30日 23:01
61. 改进：多日日期不需要区分图例，放在同一个时间维度对比 ✅已完成 (重叠对比模式) 2026年1月30日 23:01
62. 增加：网站专属图标 (Favicon) ✅已完成 2026年1月30日 23:01
63. BUG：stop.sh 打不开 ✅已修复 2026年1月30日 23:11
64. 坐标轴设置项通过左边框和输入框底纹实时匹配对应系列的颜色。 这个不够明显 ✅ 2026年1月30日 23:11
65. 改进：点击删除按钮需要确认 ✅ 2026年1月30日 23:31
66. 改进：坐标轴设置，上下调整的步长为最大值的5% ✅ 2026年1月30日 23:31
67. BUG：选择两天日期并开启24小时曲线重叠时，网页黑屏 ✅已修复 2026年1月30日 23:31
68. 改进：历史存单删除也需要确认 ✅ 2026年1月30日 23:31
69. BUG：重启后端后历史数据没有了，已实现 SQLite 数据库持久化 ✅ 2026年1月30日 23:50
70. 优化：历史存单显示改为紧凑型，增加搜索与头像识别 ✅ 2026年1月30日 23:50
71. 改进：多日对比模式下，相同指标共用一个图例开关 ✅ 2026年1月30日 23:50
72. 改进：坐标轴增加颜色选择器，支持自定义图例颜色 ✅ 2026年1月30日 23:50
73. 改进：提供 sample_data.csv 范例文件，优化导入引导 ✅ 2026年1月30日 23:50
74. 改进：增加图例“全选/全不选”功能 ✅ 2026年1月30日 23:50
75. 改进：坐标轴设置支持基于当前值调整，并适配负数量程 ✅ 2026年1月30日 23:50
76. 改进：多日日期选择时，同一个数据共用图例 ✅ 2026年1月30日 23:44
77. 优化：优化历史存单显示，不要浪费空间 ✅ 2026年1月30日 23:44
78. 改进：可以调整图例颜色 ✅ 2026年1月30日 23:44
79. 改进：可以取消全选和全选图例 ✅ 2026年1月30日 23:44
80. 增加：历史数据搜索功能 ✅ 2026年1月30日 23:50
81. BUG：重启后端后，历史数据没有了，使用数据库持久化 ✅ 2026年1月30日 23:50
82. **2026-01-31**:
    - **BUG修复**: 优化 CSV 导出逻辑，现在导出的数据包含日期、时间及所有维度分列，完全符合导入规范。 (修改人: Antigravity) ✅ 2026年1月31日 09:46
    - **功能改进**: 实现坐标轴负数自适应，当数据包含负值时，坐标轴下限自动调整为最小值 110%。 (修改人: Antigravity) ✅ 2026年1月31日 09:54
    - **功能改进**: 增加历史存单“一键清空”功能，支持批量管理历史快照。 (修改人: Antigravity)
    - **规范化**: 更新范例文件 (sample_weather.csv) 并修复前端下载链接。 (修改人: Antigravity)
    - **BUG修复**: 坐标轴调节逻辑优化，按上下键调整时以实时默认值为基准，且不再强制起步为0。 (修改人: Antigravity) ✅ 2026年1月31日 11:30
    - **BUG修复**: 修复“清空历史”按钮在特定环境下无效的问题，增加后端反馈与提示。 (修改人: Antigravity) ✅ 2026年1月31日 11:30
    - **功能改进**: 实现时间粒度聚合分析（时、日、月、年），支持多层级数据钻取查看。 (修改人: Antigravity) ✅ 2026年1月31日 11:30
    - **交互优化**: 侧边栏坐标轴与图例显示状态强关联：隐藏图例时侧边栏对应项置灰并取消色彩条。 (修改人: Antigravity) ✅ 2026年1月31日 11:30

83. 浅色模式选到圆点时放大的白色，对比度不足 ✅ 2026年1月31日 10:20
84. 历史快照库排版需要完善，宽窄切换和清空、搜索不要挤在同一行 ✅ 2026年1月31日 10:20
85. 把图例全选、全不选按钮缩小放到图例附近 ✅ 2026年1月31日 10:40
86. 把存入历史按钮放到顶部 ✅ 2026年1月31日 10:40
87. 切换时间颗粒度 ✅ 2026年1月31日 10:40
88. 浅色模式选中圆点样式优化 ✅ 2026年1月31日 11:10
89. 侧边栏列表颜色标识 ✅ 2026年1月31日 11:10
90. 时间粒度重定义与精度修复 ✅ 2026年1月31日 11:10
91. 重置面板功能修复，包含图例恢复 ✅ 2026年1月31日 11:10
92. 后端详细操作日志实现 ✅ 2026年1月31日 11:10
93. 纵坐标的数值，小数点仅保持2位小数 ✅ 2026年1月31日 11:25
94. 选中数据详情，也可以点击选择或取消选择该图例 ✅ 2026年1月31日 11:25
95. 点击时间粒度的月、年时横坐标自动对齐月份/年份全景 ✅ 2026年1月31日 11:35
96. 选中数据详情，和图例一样，没选上的图例也不显示颜色 ✅ 2026年1月31日 11:25
97. 浅色模式系列详情列表文字对比度优化 ✅ 2026年1月31日 11:35
98. 访问日志功能上线，支持查看最近 100 条记录及 30 天自动清理 ✅ 2026年1月31日 11:35
99. 增加告警日志功能，支持 error.log 全局错误捕获与独立查看 ✅ 2026年1月31日 11:45
100. 系统访问日志 UI 深度优化，支持搜索、轨道切换与 CSV 导出 ✅ 2026年1月31日 11:45
101. 全局数字显示优化：无小数位不显示，有小数位最多 2 位 ✅ 2026年1月31日 11:45
102. 坐标轴上限默认值直接在格子里填好数值，便于点击调节 ✅ 2026年1月31日 11:45
103. 实现“显示总计”功能，支持实际功率(MWh)、辐照度(MJ/m²)、风速(均值)等特定转换 ✅ 2026年1月31日 12:00
104. 增加粒度内范围微调功能，支持自定义“日/月/年”视图的起止刻度 ✅ 2026年1月31日 12:00
105. 辐照度计算错误（Wh/m² 未转换为 MJ/m²） ✅ 2026年1月31日 12:05
106. 移除 SVG 导出功能，保持核心数据分析体验的纯净性 ✅ 2026年1月31日 12:20
107. 移除计算器功能，以确保跨平台系统的通用性与整洁性 ✅ 2026年1月31日 12:15
108. 后端日志引用变量未定义导致启动崩溃（已修复） ✅ 2026年1月31日 12:25
109. 存入历史功能失效（由于后端崩溃引起，已修复） ✅ 2026年1月31日 12:25
110. 默认勾选显示总计值 ✅ 2026年1月31日 12:52
111. 增加功率值可以统一设置上下限 ✅ 2026年1月31日 12:52
112. 辐照度默认范围是0-1000 ✅ 2026年1月31日 12:52
113. 增加调节系数，上下限统一按此系数修改 ✅ 2026年1月31日 12:52
114. 开放数据修改功能，支持手动微调数值、系列名称及指标名称 ✅ 2026年1月31日 13:25
115. 实现出清曲线、短期预测、负荷等指标的自动功率判定与 MW/MWh 单位转换 ✅ 2026年1月31日 13:38

## 需求

### 改进

### 规划

完善多维度分析的筛选交互。
